#:import MDRaisedButton kivymd.uix.button.MDRaisedButton

WindowManager:
    FirstWindow:
    SecondWindow:
    MapWindow:
    CallboardWindow:
    Stops:
    AboutAPP:

<FirstWindow>:
    name: "first"

    MDBoxLayout:
        orientation: "vertical"
        spacing: 5
        padding: 10

        Image:
            source: "logo.png"

        # Добавляем две новые кнопки
        MDRaisedButton:
            text: "Войти как пользователь"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            on_release: 
                root.onmap()
                app.root.current = "map"
                        

        MDRaisedButton:
            text: "Войти как водитель"
            pos_hint: {'center_x': 0.5}
            on_release: 
                app.root.current = "second"
                root.manager.transition.direction = "left"

<SecondWindow>:
    name: "second"

    MDBoxLayout:
        orientation: "vertical"
        spacing: 5
        padding: 10

        Image:
            source: "logo.png"

        MDTextField:
            id: username_field
            hint_text: "Логин"
            pos_hint: {'center_x': 0.5}
            size_hint_x: None
            width: 200

        MDTextField:
            id: password_field
            hint_text: "Пароль"
            pos_hint: {'center_x': 0.5}
            size_hint_x: None
            width: 200
            password: True

        MDRaisedButton:
            text: "Войти"
            pos_hint: {'center_x': 0.5}
            on_release: root.login_button_pressed()
            
<MapWindow>:
    name: "map"

    MDBoxLayout:
        orientation: 'vertical'
        theme_style: "Dark"

        MDTopAppBar:
            title: "Карта"
            left_action_items: [["menu", root.open_menu]]
            elevation: 10

        MapView:
            id: map_view
            zoom: 12
            lat: 50.0965
            lon: 45.4165

            on_kv_post:
                root.add_marker()

        MDBoxLayout:
            size_hint_y: None
            height: dp(48)
            padding: dp(8)
            spacing: dp(10)

            MDFlatButton:
                text: "Остановки"
                md_bg_color: app.theme_cls.primary_color
                size_hint_x: 1
                on_release:
                    root.white()
                    app.root.current = "Stops"
                    root.manager.transition.direction = "up"

            MDFlatButton:
                text: "Доска объявлений"
                md_bg_color: app.theme_cls.primary_color
                size_hint_x: 1
                on_release: 
                    app.root.current = "CallboardWindow"
                    root.manager.transition.direction = "up"

<CallboardWindow>:
    name: "CallboardWindow"

    MDBoxLayout:
        orientation: 'vertical'
        theme_style: "Dark" 

        Label:
			text: "CallboardWindow"
			font_size: 32

        MDRaisedButton:
            text: "Вернутся на карту"
            pos_hint: {'center_x': 0.5}
            on_release: 
                app.root.current = "map"
                root.manager.transition.direction = "down"



<Stops>:
    name: "Stops"

    MDBoxLayout:
        
        orientation: 'vertical'
        theme_style: "Dark"

        ScrollView:
            MDList:
                id: stop_list



    MDRaisedButton:
        text: "Показать"
        pos_hint: {'center_x': 0.1}
        on_release: 
            root.create_stop_list()

    MDRaisedButton:
        text: "Вернуться на карту"
        pos_hint: {'center_x': 0.5}
        on_release:
            root.onmap()
            app.root.current = "map"
            root.manager.transition.direction = "down"
        on_kv_post:
            root.create_stop_list()



<AboutAPP>:
    name: "AboutAPP"

    MDBoxLayout:
        orientation: 'vertical'
        theme_style: "Dark"
        padding: 10
        spacing: 10

        Image:
            source: 'logo.png'
            size_hint: None, None  # Отключаем автоматическое масштабирование
            size: dp(400), dp(250)  # Задаем размеры в dp (плотностно-независимые пиксели)
            pos_hint: {'center_x': 0.5, 'center_y': 0.7}

        Label:
            text: 'Приложение для удобного отслеживания маршрутов такси в Камышине.\nБыстро находите маршруты и следите за транспортом в реальном времени.'
            size_hint: 1, 0.7
            halign: 'center'
            valign: 'middle'
            text_size: self.width, None
            color: 0, 0, 0, 1

        Label:
            text: 'Автор: Аверьянов Максим'
            size_hint: 1, 0.5
            halign: 'center'
            valign: 'middle'
            text_size: self.width, None
            color: 0, 0, 0, 1

        MDRaisedButton:
            text: "Вернуться на карту"
            pos_hint: {'center_x': 0.5}
            on_release: 
                root.onmap()
                app.root.current = "map"
                root.manager.transition.direction = "down"
